#!/usr/bin/env php
<?php
// URL of the webpage you want to read
$url = $argv[1];

// Use file_get_contents to read the content of the webpage
$htmlContent = file_get_contents($url);

// Check if the webpage was successfully fetched
if ($htmlContent === FALSE) {
    echo "Error: Unable to fetch the webpage.";
} else {
    if (preg_match('/<main.*<\/main>/s', $htmlContent, $match)) {
        $htmlContent = $match[0];
    }
    $htmlContent = preg_replace('#<script.*</script>#s', ' ', $htmlContent);
    $htmlContent = preg_replace('#&nbsp;#', ' ', $htmlContent);

    // Use strip_tags to remove HTML tags and get only the text
    $textContent = preg_replace('/<.*?>/', ' ', $htmlContent);

    // Print the plain text content
    echo "Summarize and explain this text using simple English in 1-3 paragraphs:\n";
    $lines = explode("\n", $textContent);
    foreach ($lines as $line) {
        $line = trim($line);
        if ($line) {
            echo $line . "\n";
        }
    }
}
